@using Microsoft.AspNetCore.Http
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
<script src="~/js/3.3.1Version/jquery.min.js"></script>
<style>
    table,
    th,
    td, 
    tr {
        border: 1px solid black;
        border-collapse: collapse;
        text-align: center;
    }
    .wd100{
        width: 100%;
    }
    .wd50{
        width: 50%;
    }
    .wd16{
        width: 16.66%;
    }
    .wd33{
        width: 33.32%;
    }
    .ht30{
        height: 30px;
    }
    .wd16ht30{
        width: 16.66%;
        height: 30px
    }
    .textcenterborder {
        border: 1px solid black;
        border-collapse: collapse;
        text-align: center;
    }
    .textleftborder {
        border: 1px solid black;
        border-collapse: collapse;
        text-align: left;
    }
    .sizeborder {
        width: 100%;
        border: 1px solid black;
        border-collapse: collapse;
    }
    .Border0px{
        width: 100%;
    }
</style>

<div class="row">
<div class="col-md-2"></div>
<div class="col-md-8" style="padding: 19px;border: 1px solid black; background-color: white;">

    <table class="wd100">
        <tr class="sizeborder">
        <td class="textcenterborder" rowspan="2" style="font-weight: bolder;color: #2979cb ;width:150px" height="60">
            <img src="../image/Daimler_Header_Logo_Observation.png" alt="" style="width: 75%;" /></td>
        <td class="textcenterborder" rowspan="2" style="font-weight: bold;font-size: 20px;">Observation Sheet </br> Thread Gauges</td>
        <td class="textleftborder"  height="30">Format No.</td>
        <td class="textcenterborder">365.QM.D.835</td>
    </tr>
    <tr>
        <td class="textleftborder"  height="30">RevNo & </br>Date
</td>
        <td class="textcenterborder">01/ 12.08.2019</td>
    </tr>
    </table>
    <br>
    <table class="wd100">
        <tr>
        <td class="textleftborder">Name</td>
        <td class="textleftborder">@Model.Name</td>
        <td class="textleftborder">Range</td>
        <td class="textleftborder">@Model.Range</td>
        <td class="textleftborder">Make</td>
        <td class="textleftborder">@Model.Make</td>
       </tr>
       <tr>
        <td class="textleftborder">Serial No.</td>
        <td class="textleftborder">@Model.SerialNo</td>
        <td class="textleftborder">ID No.</td>
        <td class="textleftborder">@Model.IdNo</td>
        <td class="textleftborder">Ref Std</td>
        <td class="textleftborder">@Model.RefStd</td>
        </tr>
        <tr>
        <td>Temp@Start <sup>o</sup>C</td>
        <td><input type="text" value="@Model.TempStart" id="TempStart" class="Border0px"></td>
        <td>Temp@End <sup>o</sup>C</td>
        <td><input type="text" value="@Model.TempEnd" id="TempEnd" class="Border0px"></td>
        <td>Humidity %RH</td>
        <td><input type="text" value="@Model.Humidity" id="Humidity" class="Border0px"></td>
        </tr>
        <tr>
        <td rowspan="2" colspan="4" class="textleftborder">Condition of Thread Gauge </br>
        <textarea name="ThreadgaugeCondtion" id="ThreadgaugeCondtion" style="height: 50px;width: 400px;">@Model.ThreadgaugeCondtion</textarea></td>
        <td class="textleftborder" colspan="2">Ref WI:  <input type="text" name="RefWi"id="RefWi" value="@Model.RefWi" class="size" style="width: 140px;" @Model.IsDisabled></td>
    </tr>
    <tr>
        <td class="textleftborder" colspan="2">All Values Are In <input type="text" style="width: 60px;" name="Allvalues"id="Allvalues" value="@Model.Allvalues" class="size" @Model.IsDisabled></td>
    </tr>
    </table>
    <br>
    </table>
    @if(@Model.ObsSubType==80){
    <br>
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td class="wd50">Thread Plug Gauge: Go</td>
            <td class="wd50">Thread Plug Gauge: NoGo</td>
        </tr>
        <tr>
            <td class="wd50">Effective Diameter Spec.</td>
            <td class="wd50">Effective Diameter Spec.</td>
        </tr>
    </table>
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td class="wd16">Max</td>
            <td class="wd16">Min</td>
            <td class="wd16">Wear Limit</td>
            <td class="wd16">Max</td>
            <td class="wd16">Min</td>
            <td class="wd16">Wear Limit</td>
        </tr>
        <tr>
            <td class="wd16ht30"><input type="text" id="Max1" name="Max1" value="@Model.Max1"
                    class="wd100"></td>
            <td class="wd16ht30"><input type="text" id="Min1" name="Min1" value="@Model.Min1"
                    class="wd100"></td>
            <td class="wd16ht30"><input type="text" id="WearLimit1" name="WearLimit1" value="@Model.WearLimit1"
                    class="wd100"></td>
            <td class="wd16ht30"><input type="text" id="Max2" name="Max2" value="@Model.Max2"
                    class="wd100"></td>
            <td class="wd16ht30"><input type="text" id="Min2" name="Min2" value="@Model.Min2"
                    class="wd100"></td>
            <td class="wd16ht30"><input type="text" id="WearLimit2" name="WearLimit2" value="@Model.WearLimit2"
                    class="wd100"></td>
        </tr>
        </table>
    <br>
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td class="wd16">Actual: Plane1</td>
            <td class="wd33"><input type="text" id="Plane1" name="Plane1" value="@Model.Plane1" class="wd100"></td>
            <td class="wd16">Actual: Plane1</td>
            <td class="wd33"><input type="text" id="Plane2" name="Plane2" value="@Model.Plane2" class="wd100"></td>
        </tr>
        <tr>
            <td class="wd16">Actual: Plane2</td>
            <td class="wd33"><input type="text" id="Plane3" name="Plane3" value="@Model.Plane3" class="wd100"></td>
            <td class="wd16">Actual: Plane2</td>
            <td class="wd33"><input type="text" id="Plane4" name="Plane5" value="@Model.Plane4" class="wd100"></td>
        </tr>
        <tr>
            <td class="wd16">Actual: Plane3</td>
            <td><input type="text" id="Plane5" name="Plane5" value="@Model.Plane5" class="wd100"></td>
            <td colspan="2"></td>
        </tr>
    </table>
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td colspan="5">Repeatability</td>
        </tr>
        <tr>
            <td class="ht30"><input type="text" value="@Model.Repeatability1" id="Repeatability1" name="Repeatability1" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability2" id="Repeatability2" name="Repeatability2" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability3" id="Repeatability3" name="Repeatability3" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability4" id="Repeatability4" name="Repeatability4" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability5" id="Repeatability5" name="Repeatability5" class="wd100"></td>
        </tr>
    </table>
    <br> <br>
    }
    @if(@Model.ObsSubType==81){
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td class="wd50">Thread Ring Gauge: Go</td>
            <td class="wd50">Thread Ring Gauge: NoGo</td>
        </tr>
        <tr>
            <td class="wd50">Effective Diameter Spec.</td>
            <td class="wd50">Effective Diameter Spec.</td>
        </tr>
    </table>
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td>Max</td>
            <td>Min</td>
            <td>Wear Limit</td>
            <td>Max</td>
            <td>Min</td>
            <td>Wear Limit</td>
        </tr>
        <tr>
            <td class="ht30"><input type="text" id="Ring_Max1" name="Ring_Max1" value="@Model.Max1" class="wd100"></td>
            <td class="ht30"><input type="text" id="Ring_Min1" name="Ring_Min1" value="@Model.Min1" class="wd100"></td>
            <td class="ht30"><input type="text" id="Ring_WearLimit1" name="Ring_WearLimit1" value="@Model.WearLimit1" class="wd100"></td>
            <td class="ht30"><input type="text" id="Ring_Max2" name="Ring_Max2" value="@Model.Max2" class="wd100"></td>
            <td class="ht30"><input type="text" id="Ring_Min2" name="Ring_Min2" value="@Model.Min2" class="wd100"></td>
            <td class="ht30"><input type="text" id="Ring_WearLimit2" name="Ring_WearLimit2" value="@Model.WearLimit2" class="wd100"></td>
        </tr>
    </table>
    <br>
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td class="wd16">Actual: Plane1</td>
            <td class="wd33"><input type="text" id="Ring_Plane1" name="Ring_Plane1" value="@Model.Plane1" class="wd100"></td>
            <td class="wd16">Actual: Plane1</td>
            <td class="wd33"><input type="text" id="Ring_Plane2" name="Ring_Plane2" value="@Model.Plane2" class="wd100"></td>
        </tr>
        <tr>
            <td class="wd16">Actual: Plane2</td> 
            <td class="wd33"><input type="text" id="Ring_Plane3" name="Ring_Plane3" value="@Model.Plane3" class="wd100"></td>
            <td class="wd16">Actual: Plane2</td>
            <td class="wd33"><input type="text" id="Ring_Plane4" name="Ring_Plane4" value="@Model.Plane4" class="wd100"></td>
        </tr>
        <tr>
            <td class="wd16">Actual: Plane3</td>
            <td><input type="text" id="Ring_Plane5" name="Ring_Plane5" value="@Model.Plane5" class="wd100"></td>
            <td colspan="2"></td>
        </tr>
    </table>
    <table style="width: 100%;" style="font-weight: bold;">
        <tr>
            <td colspan="5" style="font-weight: bold;">Repeatability</td>
        </tr>
        <tr>
            <td class="ht30"><input type="text" value="@Model.Repeatability1" id="Ring_Repeatability1" name="Ring_Repeatability1" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability2" id="Ring_Repeatability2" name="Ring_Repeatability2" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability3" id="Ring_Repeatability3" name="Ring_Repeatability3" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability4" id="Ring_Repeatability4" name="Ring_Repeatability4" class="wd100"></td>
            <td class="ht30"><input type="text" value="@Model.Repeatability5" id="Ring_Repeatability5" name="Ring_Repeatability5" class="wd100"></td>
        </tr>
    </table>
    <br><br>
    }
    <table class="wd100" style="font-weight: bold;">
        <tr>
            <td>Calibration Performed BY</td>
            <td><input type="text" value="@Model.CalibrationPerformedBy" id="CalibrationPerformedBy" name="CalibrationPerformedBy" class="wd100" disabled ></td>
            <td>Reviewed By</td>
            <td><input type="text" value="@Model.ReviewedBy" id="ReviewedBy" name="ReviewedBy" class="wd100" disabled></td>
        </tr>
        <tr>
            <td class="textleftborder">Date</td>   
            @if(true)
            {
                var performDate = @Model.CalibrationPerformedDate.ToString("dd-MM-yyyy");
                <td><input type="text" value="@performDate" id="CreatedOn" name="CreatedOn"
                        class="wd100" disabled>
                </td>
            } 
            
            <td class="textleftborder">Date</td>
                @if (@HttpContextAccessor.HttpContext.Session.GetString("UserRoleId") == "1" 
                    || @HttpContextAccessor.HttpContext.Session.GetString("UserRoleId") == "2"){
                        <td><input type="text" name="Review_Date" id="Review_Date" 
                                value="@Model.Review_Date" class="size" disabled>
                        </td>
                }else if (@HttpContextAccessor.HttpContext.Session.GetString("UserRoleId") == "4"){
                    <td>        
                            <div class="form-group">  
                                <div class="input-group date" id="reservationdate" data-target-input="nearest" onchange="$('#ReviewDate').attr('value',$('#ReviewDate').val());">
                                    <input type="text" class="form-control datetimepicker-input" data-target="#reservationdate"
                                    id="ReviewDate" name="ReviewDate" value="@Model.CalibrationReviewedDate"  @Model.IsDisabled>
                                    <div class="input-group-append" data-target="#reservationdate" data-toggle="datetimepicker">
                                    <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                                    </div>
                                </div>
                            </div>
                    </td>
                }
        </tr>
        @if (@HttpContextAccessor.HttpContext.Session.GetString("UserRoleId") == "4" || @Model.ReviewStatus != null )
        {
                <tr>
                        <td class="textleftborder">Status</td>
                        <td class="textleftborder" colspan="3">
                            <div style="text-align: left;">
                                <label>Approve</label>
                                <input type="radio" name="Approve" id="Approve">
                                <label>Reject</label>
                                <input type="radio" name="Approve" id="Reject">
                            </div>
                        </td>

                </tr>
        }
        @if (@HttpContextAccessor.HttpContext.Session.GetString("UserRoleId") != "4"){
            <tr>
                <td colspan="4">
                    @if(@Model.ReviewStatus == null || @Model.ReviewStatus == 0 )
                    {
                        <input type="button" class="btn btn-primary" value="Save" name="Save" id="ThreadGauges" onclick="SaveThreadGauges()">
                    }
                    <a class="btn btn-primary" href='@Url.Action("Request","Tracker",new {reqType=4})'>Cancel</a>
                </td>
            </tr>
        }
        @if (@HttpContextAccessor.HttpContext.Session.GetString("UserRoleId") == "4")
        {
                <tr>
                    <td colspan="4" style="text-align:center;">
                        @if(@Model.ReviewStatus == null || @Model.ReviewStatus == 0 )
                        {
                            <input type="button" class="btn btn-primary" value="Submit Review" name="Submit" 
                                                 id="LeverDial" onclick="SubmitReview()" @Model.IsDisabled>
                        }
                        <a class="btn btn-primary" href='@Url.Action("Request","Tracker",new {reqType=4})'>Cancel</a>    
                    </td>
                </tr>
        }
</table>  
    <input type="hidden" id="instrumentId" value="@Model.InstrumentId">
    <input type="hidden" id="requestId" value="@Model.RequestId">
    <input type="hidden" id="ReviewStatus" name="ReviewStatus" value="@Model.ReviewStatus">
    <input type="hidden" name="TemplateObservationId" Id="TemplateObservationId" value="@Model.TemplateObservationId">
    <input type="hidden" name="Id" Id="Id" value="@Model.Id">
    <input type="hidden" name="ObsSubType" Id="ObsSubType" value="@Model.ObsSubType">
</div>
<div class="col-md-2"></div>
</div>



<script type="text/javascript">
    $(function () {

        $('#Approve').on('change', function () {
            if ($('#Approve').not(this).prop('checked', false)) {
                $('#ReviewStatus').val(1);
            }
        });

        $('#Reject').on('change', function () {
            if ($('#Reject').not(this).prop('checked', false)) {
                $('#ReviewStatus').val(2);
            }

        });

        var reviewStatus = $('#ReviewStatus').val();
        if (reviewStatus == 1) {
            $('#Approve').prop('checked', true);
            $('#Reject').prop('checked', false);
        }
        else if (reviewStatus == 2) {
            $('#Approve').prop('checked', false);
            $('#Reject').prop('checked', true);
        }
    });

</script>
 <script>
    setTimeout(function () {

    $('#reservationdate').datetimepicker({
     format: 'DD/MM/YYYY'
    });
    }, 1000);

    </script> 